<ion-content>
  <div class="InputContainer">
    <input
      id="input"
      class="input"
      name="text"
      type="text"
      [(ngModel)]="searchQuery"
      (input)="searchLocationSuggestions()"
      placeholder="Rechercher un lieu..."
      (focus)="showSuggestions = true"
      (blur)="hideSuggestions()"
    />

    <!-- üî• Improved Search Suggestions Dropdown -->
    <ul *ngIf="showSuggestions && searchResults.length > 0" class="suggestions">
      <li *ngFor="let result of searchResults" (click)="selectSuggestion(result)">
        <ion-icon name="location-outline"></ion-icon> {{ result.display_name }}
      </li>
    </ul>

    <label class="labelforsearch" for="input">
      <button (click)="searchLocation()">
        <svg class="searchIcon" viewBox="0 0 512 512">
          <path
            d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"
          ></path>
        </svg>
      </button>
    </label>
  </div>

  <!-- üî• Improved Route Inputs -->
  <div class="route-inputs">
    <ion-item>
      <ion-icon name="navigate-outline"></ion-icon>
      <ion-input [(ngModel)]="startLocation" (keyup)="searchStartSuggestions()" (blur)="hideStartSuggestions()" placeholder="Adresse de d√©part"></ion-input>
    </ion-item>

    <ul *ngIf="showStartSuggestions && startSuggestions.length > 0" class="suggestions">
      <li *ngFor="let result of startSuggestions" (click)="selectStartSuggestion(result)">
        {{ result.display_name }}
      </li>
    </ul>

    <ion-item>
      <ion-icon name="flag-outline"></ion-icon>
      <ion-input [(ngModel)]="endLocation" (keyup)="searchEndSuggestions()" (blur)="hideEndSuggestions()" placeholder="Adresse d'arriv√©e"></ion-input>
    </ion-item>

    <ul *ngIf="showEndSuggestions && endSuggestions.length > 0" class="suggestions">
      <li *ngFor="let result of endSuggestions" (click)="selectEndSuggestion(result)">
        {{ result.display_name }}
      </li>
    </ul>

    <ion-button (click)="calculateRoute(startLocation, endLocation)">
      <ion-icon name="map-outline"></ion-icon> Calculer l'itin√©raire
    </ion-button>
  </div>


  <!-- üî• Show Loading Indicator When Searching -->
  <div *ngIf="isLoading" class="loading-indicator">
    <ion-spinner name="crescent"></ion-spinner>
    <p>Calculating route...</p>
  </div>

  <!-- üî• Map Container -->
  <div id="map"></div>
</ion-content>
